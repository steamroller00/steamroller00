<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Voice Clone - Upload or Record Audio</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f6f8;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 800px;
            margin: 30px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        .upload-area, .record-area {
            padding: 20px;
            border: 2px dashed #ccc;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 20px;
        }
        .upload-area:hover, .record-area:hover {
            background-color: #f0f0f0;
        }
        button {
            padding: 10px 20px;
            background-color: #4a90e2;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #3f7dc3;
        }
        .hidden {
            display: none;
        }
        .audio-player {
            margin-top: 20px;
        }
        select, input[type="file"] {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        #displayBox {
            font-size: 16px;
            color: #333;
            line-height: 1.5;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
            margin-top: 20px;
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Voice Clone</h1>

    <!-- File Upload Section -->
    <div class="upload-area" onclick="document.getElementById('fileInput').click();">
        <p>Drag and drop an audio file here, or click to upload.</p>
        <input type="file" id="fileInput" accept="audio/*" class="hidden" onchange="loadFile(event)">
    </div>

    <!-- Recording Section -->
    <div class="record-area">
        <button id="startRecord">Start Recording</button>
        <button id="stopRecord" class="hidden">Stop Recording</button>
    </div>

    <!-- Repair Button -->
    <div style="text-align: center; margin-top: 20px;">
        <button id="repairButton">修复</button>
    </div>

    <!-- Display Box -->
    <div id="displayBox" class="hidden"></div>

    <!-- Audio Player -->
    <audio id="audioPlayer" class="audio-player" controls></audio>
</div>

<script>
    let mediaRecorder;
    let audioChunks = [];
    const startRecordButton = document.getElementById('startRecord');
    const stopRecordButton = document.getElementById('stopRecord');
    const audioPlayer = document.getElementById('audioPlayer');
    const repairButton = document.getElementById('repairButton');
    const displayBox = document.getElementById('displayBox');

    // File Upload Handler
    function loadFile(event) {
        const file = event.target.files[0];
        const url = URL.createObjectURL(file);
        audioPlayer.src = url;
    }

    // Start Recording
    startRecordButton.addEventListener('click', () => {
        navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
            mediaRecorder = new MediaRecorder(stream);
            mediaRecorder.start();
            audioChunks = [];
            mediaRecorder.ondataavailable = e => audioChunks.push(e.data);
            mediaRecorder.onstop = () => {
                const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
                const audioUrl = URL.createObjectURL(audioBlob);
                audioPlayer.src = audioUrl;
                audioPlayer.classList.remove('hidden');
            };
            startRecordButton.classList.add('hidden');
            stopRecordButton.classList.remove('hidden');
        }).catch(err => console.error("Microphone access denied!", err));
    });

    // Stop Recording
    stopRecordButton.addEventListener('click', () => {
        mediaRecorder.stop();
        startRecordButton.classList.remove('hidden');
        stopRecordButton.classList.add('hidden');
    });

    // Repair Button Handler
    repairButton.addEventListener('click', () => {
        const repairContent = `
            Sweeney's department store was having its 20th-anniversary celebration on May 3rd with an enormous sales promotion.
            Certain sections of the store were having tremendous sales, especially the dress department, the jewelry department, 
            and the furniture department. Workmen were moving busily around, carrying lumber, sawing, and hammering. They were 
            creating signs, displays, and shelving for the products going on sale. A newspaper campaign was planned in which the 
            products would be featured. The store owners hoped that customers would come to celebrate the 20 years of service to 
            the community and also take advantage of the bargains offered in many departments. They were planning to give away 
            door prizes on each one of the seven floors.
        `;
        displayBox.innerHTML = repairContent;
        displayBox.classList.remove('hidden');
    });
</script>

</body>
</html>
